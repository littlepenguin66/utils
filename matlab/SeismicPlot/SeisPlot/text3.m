function text3(x, y, z, str, varargin)
% adds a text specified by str as 3D lines plot in the current axes. The
% text is places with its lower left corner at location specified by x,y,z
% (which corresponds to 'HorizontalAlignment', 'left', 'VerticalAlignment',
% 'baseline' of MATLAB's text function). Default glyph height is approx 1
% unit, text size can be scaled using 'scale' parameter. Text default
% orientation is in xy-plane. The orinatation can be modified using
% 'rz','ry' and 'rx' parameters. Note: rotation order is rz > ry > rx.
%
% The True Type Font Simplex.ttf is implemented here. Note: only the most
% important glyphs are implemented. Instructions on how to add more glyphs
% included in description of function getGlyphData, see code below.
%
%
% Syntax:  text3(x, y, z, str, 'Param',VALUE, 'Param',VALUE, ...)
%
% Inputs:
%    x,y,z   - text position
%    str     - text string
%
% Param:
%    'scale' - scale factor
%    'rx'    - rotation angle around x-axis [rad]
%    'ry'    - rotation angle around y-axis [rad]
%    'rz'    - rotation angle around z-axis [rad]
%    'color' - text color, default 'k'
%    'linewidth' - line width for glyph contours, default 0.5
%
% Example (plot 'TEXT' in xz plane):
%    text3(0, 0, 0, 'TEXT, 'scale', 0.001, 'rx', pi/2)
%
% KARCH, October 2020
%


% default values:
scale = 1;
rx = 0;
ry = 0;
rz = 0;
color = 'k';
linewidth = 0.5;


% go through the Param and assign new values
for i = 1 : 2 : length(varargin)
    switch lower(varargin{i})
        case 'scale'
            scale = varargin{i+1};
        case 'rx'
            rx = varargin{i+1};
        case 'ry'
            ry = varargin{i+1};
        case 'rz'
            rz = varargin{i+1};
        case 'color'
            color = varargin{i+1};
        case 'linewidth'
            linewidth = varargin{i+1};
        otherwise
            error('Unknown Param.')
    end
end




% get glyph coordinates and put them together to a string
xmax = 0;
for i = 1 : numel(str)
    
    % each glyph i contains one or more contour paths j accessible via xy{i}{j}
    [xy{i}, advW(i)] = getGlyphData(str(i));
    
    % put contours j of the current glyph behind the previous glyph.
    for j = 1:numel(xy{i})
        xy{i}{j}(:,1) = xy{i}{j}(:,1) + xmax;
    end
    xmax = xmax + advW(i);
    
end



% transform the string
xyz = transformGlyph(xy, 0.001*scale, x, y, z, rx, ry, rz);


% plot the string
for i = 1 : numel(xy)
    for j = 1 : numel(xy{i})
        plot3( ...
            [xyz{i}{j}(:,1); xyz{i}{j}(1,1)], ...
            [xyz{i}{j}(:,2); xyz{i}{j}(1,2)], ...
            [xyz{i}{j}(:,3); xyz{i}{j}(1,3)], ...
            'Color', color, ...
            'LineWidth', linewidth ...
            );
        hold on
    end
end




end









function xyz = transformGlyph(xy, scale, dx, dy, dz, rx, ry, rz)
% transforms string coordinates xy (2D) in coordinates xyz (3D).
% The order of transformation is: scale > rz > ry > rx > dx > dy > dz.
%
% Inputs:
%    xy    - glyph contour 2D coordinates, cell array with dimensions
%           xy{nGlyphs}{nContours}(nPoints,xy=2)
% Outputs:
%    xyz   - glyph contour 3D coordinates, cell array with dimensions
%           xy{nGlyphs}{nContours}(nPoints,xyz=3)

% rotation matrices
rotx = [ 1 0 0 ; 0 cos(rx) -sin(rx) ; 0 sin(rx) cos(rx) ];
roty = [ cos(ry) 0 sin(ry) ; 0 1 0 ; -sin(ry) 0 cos(ry) ];
rotz = [ cos(rz) -sin(rz) 0 ; sin(rz) cos(rz) 0; 0 0 1  ];


% go through all glyphs and all contours
xyz = xy;
for i = 1 : numel(xy)
    for j = 1 : numel(xy{i})
        
        % convert 2D to 3D
        xyz{i}{j}(:,3) = 0;
        
        % scale
        xyz{i}{j} = scale * xyz{i}{j};
        
        % perform rotations: rz > ry > rx
        xyz{i}{j} = xyz{i}{j} * rotz';
        xyz{i}{j} = xyz{i}{j} * roty';
        xyz{i}{j} = xyz{i}{j} * rotx';
        
        % perform translations
        xyz{i}{j} = xyz{i}{j} + [dx dy dz];
        
    end
end


end













function [xy, advW] = getGlyphData(glyph)
% returns xy coordinates of glyph contours and advance width advW of the
% glyph. Dimensions: xy{nContours}(nPoints,xy=2)
%
% The TrueTypeFont Simplex.ttf is implemented here. The glyph contour data
% is extracted from the ttf file using https://fontdrop.info/.
%
% To add more glyphs:
% 1) download Simplex.ttf
% 2) go to https://fontdrop.info/ and load the Simplex.ttf
% 3) click on the extracted glyphs to show the xy contours data and
%    advanceWidth (no other parameters are required).
% 4) add a new case in the below switch loop and specify the required data.


switch glyph
    case '0'
        xy{1} = [
            1231 643
            1160 281
            1010 58
            787 -14
            639 -14
            416 58
            267 281
            195 643
            195 863
            267 1225
            416 1448
            639 1522
            787 1522
            1010 1448
            1160 1225
            1231 863
            ];
        xy{2} = [
            1199 648
            1199 858
            1127 1213
            990 1420
            783 1489
            644 1489
            437 1420
            299 1213
            228 858
            228 648
            299 293
            437 86
            644 17
            783 17
            990 86
            1127 293
            ];
        advW = 1426;
        
    case '1'
        xy{1} = [
            658 0
            625 0
            625 1467
            437 1276
            291 1205
            275 1233
            416 1305
            635 1522
            658 1522
            ];
        advW = 1140;
        
    case '2'
        xy{1} = [
            1215 -14
            173 -14
            916 727
            1057 940
            1127 1080
            1127 1215
            1057 1352
            990 1420
            852 1489
            574 1489
            437 1420
            369 1352
            299 1215
            299 1147
            267 1147
            267 1223
            340 1373
            416 1448
            566 1522
            861 1522
            1010 1448
            1086 1373
            1160 1223
            1160 1071
            1086 924
            941 707
            250 17
            1215 17
            ];
        advW = 1426;
        
    case '3'
        xy{1} = [
            1231 428
            1158 207
            1008 58
            787 -14
            568 -14
            347 58
            269 134
            197 279
            226 295
            297 154
            363 86
            572 17
            783 17
            992 86
            1129 224
            1199 433
            1199 572
            1129 781
            1061 846
            924 916
            680 916
            1110 1489
            355 1489
            355 1522
            1176 1522
            746 949
            932 949
            1082 875
            1158 797
            1231 576
            ];
        advW = 1426;
        
    case '4'
        xy{1} = [
            912 486
            179 486
            945 1557
            945 519
            1287 519
            1287 486
            945 486
            945 0
            912 0
            ];
        xy{2} = [
            912 519
            912 1454
            244 519
            ];
        advW = 1426;
        
    case '5'
        xy{1} = [
            1231 428
            1158 207
            1008 58
            787 -14
            568 -14
            347 58
            269 134
            197 279
            226 295
            297 154
            363 86
            572 17
            783 17
            992 86
            1129 224
            1199 433
            1199 572
            1129 781
            992 918
            783 988
            572 988
            363 918
            263 815
            340 1522
            1072 1522
            1072 1489
            369 1489
            304 906
            347 947
            568 1020
            787 1020
            1008 947
            1158 797
            1231 576
            ];
        advW = 1426;
        
    case '6'
        xy{1} = [
            1231 428
            1158 207
            1008 58
            787 -14
            711 -14
            490 58
            340 207
            267 500
            267 863
            338 1225
            412 1373
            490 1448
            711 1522
            859 1522
            1084 1448
            1158 1299
            1129 1282
            1059 1420
            854 1489
            715 1489
            506 1420
            441 1352
            371 1213
            299 858
            299 602
            340 725
            490 875
            711 949
            787 949
            1008 875
            1158 725
            1231 504
            ];
        xy{2} = [
            1199 433
            1199 500
            1129 709
            992 846
            783 916
            715 916
            506 846
            369 709
            299 502
            369 224
            506 86
            715 17
            783 17
            992 86
            1129 224
            ];
        advW = 1426;
        
    case '7'
        xy{1} = [
            1242 1522
            512 -4
            484 7
            1188 1489
            211 1489
            211 1522
            ];
        advW = 1426;
        
    case '8'
        xy{1} = [
            1231 283
            1082 58
            859 -14
            568 -14
            347 58
            269 134
            195 283
            195 506
            269 656
            418 803
            646 879
            492 916
            342 992
            267 1143
            267 1295
            342 1448
            568 1522
            859 1522
            1084 1448
            1160 1295
            1160 1143
            1084 992
            934 916
            781 879
            789 877
            1008 803
            1158 656
            1231 506
            ];
        xy{2} = [
            1127 1151
            1127 1287
            1059 1420
            854 1489
            572 1489
            367 1420
            299 1287
            299 1151
            367 1016
            504 949
            713 895
            922 949
            1059 1016
            ];
        xy{3} = [
            1199 291
            1199 498
            1129 635
            992 775
            781 844
            713 863
            646 844
            435 775
            297 635
            228 498
            228 291
            297 154
            363 86
            572 17
            854 17
            1061 86
            ];
        advW = 1426;
        
    case '9'
        xy{1} = [
            1231 643
            1160 281
            1086 134
            1008 58
            787 -14
            639 -14
            414 58
            340 207
            369 224
            439 86
            644 17
            783 17
            992 86
            1057 154
            1127 293
            1199 648
            1199 904
            1158 781
            1008 631
            787 557
            711 557
            490 631
            340 781
            267 1002
            267 1078
            340 1299
            490 1448
            711 1522
            787 1522
            1008 1448
            1158 1299
            1231 1006
            ];
        xy{2} = [
            1199 1004
            1129 1282
            992 1420
            783 1489
            715 1489
            506 1420
            369 1282
            299 1074
            299 1006
            369 797
            506 660
            715 590
            783 590
            992 660
            1129 797
            ];
        advW = 1426;
        
    case 'A'
        xy{1} = [
            1227 486
            486 486
            297 -4
            269 7
            846 1522
            868 1522
            1444 7
            1416 -4
            ];
        xy{2} = [
            1215 519
            857 1461
            498 519
            ];
        advW = 1570;
        
    case 'B'
        xy{1} = [
            926 805
            1135 875
            1201 942
            1270 1080
            1270 1215
            1201 1352
            1135 1420
            926 1489
            299 1489
            299 805
            ];
        xy{2} = [
            979 789
            1151 732
            1229 656
            1303 506
            1303 283
            1229 134
            1151 58
            930 -14
            267 -14
            267 1522
            930 1522
            1151 1448
            1229 1373
            1303 1223
            1303 1071
            1229 922
            1151 846
            ];
        xy{3} = [
            926 772
            299 772
            299 17
            926 17
            1135 86
            1201 154
            1270 291
            1270 498
            1201 635
            1135 703
            ];
        advW = 1785;
        
    case 'C'
        xy{1} = [
            1301 351
            1229 205
            1082 58
            932 -14
            637 -14
            488 58
            340 205
            269 353
            195 572
            195 934
            269 1153
            340 1301
            488 1448
            637 1522
            932 1522
            1082 1448
            1229 1301
            1301 1155
            1272 1139
            1201 1280
            1061 1420
            924 1489
            646 1489
            508 1420
            369 1280
            297 1141
            228 930
            228 576
            297 365
            369 226
            508 86
            646 17
            924 17
            1061 86
            1201 226
            1272 367
            ];
        advW = 1785;
        
    case 'D'
        xy{1} = [
            1303 572
            1229 353
            1158 205
            1008 58
            787 -14
            267 -14
            267 1522
            787 1522
            1008 1448
            1158 1301
            1229 1153
            1303 934
            ];
        xy{2} = [
            1270 576
            1270 930
            1201 1141
            1129 1280
            992 1420
            783 1489
            299 1489
            299 17
            783 17
            992 86
            1129 226
            1201 365
            ];
        advW = 1498;
        
    case 'E'
        xy{1} = [
            1215 -14
            267 -14
            267 1522
            1215 1522
            1215 1489
            299 1489
            299 805
            857 805
            857 772
            299 772
            299 17
            1215 17
            ];
        advW = 1355;
        
    case 'F'
        xy{1} = [
            1215 1489
            299 1489
            299 805
            857 805
            857 772
            299 772
            299 0
            267 0
            267 1522
            1215 1522
            ];
        advW = 1283;
        
    case 'G'
        xy{1} = [
            1303 355
            1229 205
            1082 58
            932 -14
            637 -14
            488 58
            340 205
            269 353
            195 572
            195 934
            269 1153
            340 1301
            488 1448
            637 1522
            932 1522
            1082 1448
            1229 1301
            1301 1155
            1272 1139
            1201 1280
            1061 1420
            924 1489
            646 1489
            508 1420
            369 1280
            297 1141
            228 930
            228 576
            297 365
            369 226
            508 86
            646 17
            924 17
            1061 86
            1201 226
            1270 363
            1270 557
            928 557
            928 590
            1303 590
            ];
        advW = 1498;
        
    case 'H'
        xy{1} = [
            1375 0
            1342 0
            1342 772
            299 772
            299 0
            267 0
            267 1506
            299 1506
            299 805
            1342 805
            1342 1506
            1375 1506
            ];
        advW = 1641;
        
    case 'I'
        xy{1} = [
            299 0
            267 0
            267 1506
            299 1506
            ];
        advW = 566;
        
    case 'J'
        xy{1} = [
            1016 357
            943 136
            867 58
            717 -14
            566 -14
            416 58
            340 136
            267 357
            267 502
            299 502
            299 361
            369 152
            437 86
            574 17
            709 17
            846 86
            914 152
            984 361
            984 1506
            1016 1506
            ];
        advW = 1140;
        
    case 'K'
        xy{1} = [
            1299 11
            1274 -8
            639 836
            299 496
            299 0
            267 0
            267 1506
            299 1506
            299 541
            1274 1518
            1299 1493
            664 858
            ];
        advW = 1570;
        
    case 'L'
        xy{1} = [
            1072 -14
            267 -14
            267 1506
            299 1506
            299 17
            1072 17
            ];
        advW = 1140;
        
    case 'M'
        xy{1} = [
            1446 0
            1414 0
            1414 1418
            874 0
            840 0
            299 1418
            299 0
            267 0
            267 1522
            294 1522
            857 45
            1419 1522
            1446 1522
            ];
        advW = 1713;
        
    case 'N'
        xy{1} = [
            1303 0
            1268 0
            299 1452
            299 0
            267 0
            267 1506
            302 1506
            1270 54
            1270 1506
            1303 1506
            ];
        advW = 1570;
        
    case 'O'
        xy{1} = [
            1375 572
            1301 353
            1229 205
            1082 58
            932 -14
            637 -14
            488 58
            340 205
            269 353
            195 572
            195 934
            269 1153
            340 1301
            488 1448
            637 1522
            932 1522
            1082 1448
            1229 1301
            1301 1153
            1375 934
            ];
        xy{2} = [
            1342 576
            1342 930
            1272 1141
            1201 1280
            1061 1420
            924 1489
            646 1489
            508 1420
            369 1280
            297 1141
            228 930
            228 576
            297 365
            369 226
            508 86
            646 17
            924 17
            1061 86
            1201 226
            1272 365
            ];
        advW = 1570;
        
    case 'P'
        xy{1} = [
            299 701
            299 0
            267 0
            267 1522
            930 1522
            1151 1448
            1229 1373
            1303 1223
            1303 1000
            1229 850
            1151 775
            930 701
            ];
        xy{2} = [
            299 734
            926 734
            1135 803
            1201 871
            1270 1008
            1270 1215
            1201 1352
            1135 1420
            926 1489
            299 1489
            ];
        advW = 1498;
        
    case 'Q'
        xy{1} = [
            1375 572
            1301 353
            1229 205
            1094 72
            1299 -129
            1274 -153
            1067 52
            932 -14
            637 -14
            488 58
            340 205
            269 353
            195 572
            195 934
            269 1153
            340 1301
            488 1448
            637 1522
            932 1522
            1082 1448
            1229 1301
            1301 1153
            1375 934
            ];
        xy{2} = [
            1342 576
            1342 930
            1272 1141
            1201 1280
            1061 1420
            924 1489
            646 1489
            508 1420
            369 1280
            297 1141
            228 930
            228 576
            297 365
            369 226
            508 86
            646 17
            924 17
            1043 76
            844 275
            869 299
            1072 95
            1201 226
            1272 365
            ];
        advW = 1570;
        
    case 'R'
        xy{1} = [
            1303 1071
            1229 922
            1151 846
            930 772
            816 772
            1301 9
            1272 -6
            777 772
            299 772
            299 0
            267 0
            267 1522
            930 1522
            1151 1448
            1229 1373
            1303 1223
            ];
        xy{2} = [
            1270 1080
            1270 1215
            1201 1352
            1135 1420
            926 1489
            299 1489
            299 805
            926 805
            1135 875
            1201 942
            ];
        advW = 1498;
        
    case 'S'
        xy{1} = [
            1303 209
            1151 58
            930 -14
            639 -14
            418 58
            271 203
            295 228
            435 86
            644 17
            926 17
            1135 86
            1270 222
            1270 426
            1201 564
            1133 631
            994 703
            564 846
            416 918
            340 994
            267 1143
            267 1297
            418 1448
            639 1522
            930 1522
            1151 1448
            1299 1303
            1274 1278
            1135 1420
            926 1489
            644 1489
            435 1420
            299 1284
            299 1151
            369 1014
            437 947
            576 875
            1006 732
            1154 660
            1229 584
            1303 435
            ];
        advW = 1426;
        
    case 'T'
        xy{1} = [
            1287 1489
            801 1489
            801 0
            768 0
            768 1489
            283 1489
            283 1522
            1287 1522
            ];
        advW = 1283;
        
    case 'U'
        xy{1} = [
            1303 428
            1229 207
            1080 58
            859 -14
            711 -14
            490 58
            340 207
            267 428
            267 1506
            299 1506
            299 433
            369 224
            506 86
            715 17
            854 17
            1063 86
            1201 224
            1270 433
            1270 1506
            1303 1506
            ];
        advW = 1570;
        
    case 'V'
        xy{1} = [
            1444 1500
            874 0
            840 0
            269 1500
            297 1512
            857 45
            1416 1512
            ];
        advW = 1426;
        
    case 'W'
        xy{1} = [
            1733 1502
            1375 0
            1341 0
            1000 1434
            659 0
            625 0
            267 1502
            299 1510
            642 72
            983 1506
            1017 1506
            1358 72
            1700 1510
            ];
        advW = 1713;
        
    case 'X'
        xy{1} = [
            1301 9
            1272 -6
            785 723
            297 -6
            269 9
            764 752
            269 1497
            297 1514
            785 783
            1272 1514
            1301 1497
            805 752
            ];
        advW = 1426;
        
    case 'Y'
        xy{1} = [
            1442 1495
            873 783
            873 0
            840 0
            840 783
            271 1495
            295 1516
            857 815
            1418 1516
            ];
        advW = 1426;
        
    case 'Z'
        xy{1} = [
            1246 1522
            242 17
            1215 17
            1215 -14
            181 -14
            1184 1489
            211 1489
            211 1522
            ];
        advW = 1426;
        
    case 'a'
        xy{1} = [
            1088 0
            1055 0
            1055 177
            938 58
            789 -14
            566 -14
            416 58
            269 207
            195 428
            195 576
            269 797
            416 947
            566 1020
            789 1020
            938 947
            1055 828
            1055 1004
            1088 1004
            ];
        xy{2} = [
            1055 222
            1055 783
            918 918
            781 988
            574 988
            437 918
            297 781
            228 572
            228 433
            297 224
            437 86
            574 17
            781 17
            918 86
            ];
        advW = 1355;
        
    case 'b'
        xy{1} = [
            1160 428
            1086 207
            938 58
            789 -14
            566 -14
            416 58
            299 177
            299 0
            267 0
            267 1506
            299 1506
            299 828
            416 947
            566 1020
            789 1020
            938 947
            1086 797
            1160 576
            ];
        xy{2} = [
            1127 433
            1127 572
            1057 781
            918 918
            781 988
            574 988
            437 918
            299 783
            299 222
            437 86
            574 17
            781 17
            918 86
            1057 224
            ];
        advW = 1355;
        
    case 'c'
        xy{1} = [
            1084 203
            938 58
            789 -14
            566 -14
            416 58
            269 207
            195 428
            195 576
            269 797
            416 947
            566 1020
            789 1020
            938 947
            1084 801
            1059 777
            918 918
            781 988
            574 988
            437 918
            297 781
            228 572
            228 433
            297 224
            437 86
            574 17
            781 17
            918 86
            1059 228
            ];
        advW = 1283;
        
    case 'd'
        xy{1} = [
            1088 0
            1055 0
            1055 177
            938 58
            789 -14
            566 -14
            416 58
            269 207
            195 428
            195 576
            269 797
            416 947
            566 1020
            789 1020
            938 947
            1055 828
            1055 1506
            1088 1506
            ];
        xy{2} = [
            1055 222
            1055 783
            918 918
            781 988
            574 988
            437 918
            297 781
            228 572
            228 433
            297 224
            437 86
            574 17
            781 17
            918 86
            ];
        advW = 1355;
        
    case 'e'
        xy{1} = [
            1088 557
            228 557
            228 433
            297 224
            437 86
            574 17
            781 17
            918 86
            1059 228
            1084 203
            938 58
            789 -14
            566 -14
            416 58
            269 207
            195 428
            195 576
            269 797
            416 947
            566 1020
            789 1020
            938 947
            1014 871
            1088 721
            ];
        xy{2} = [
            1055 590
            1055 713
            986 850
            918 918
            781 988
            574 988
            437 918
            297 781
            234 590
            ];
        advW = 1283;
        
    case 'f'
        xy{1} = [
            713 1489
            574 1489
            441 1422
            371 1217
            371 1020
            642 1020
            642 988
            371 988
            371 0
            338 0
            338 988
            140 988
            140 1020
            338 1020
            338 1221
            412 1446
            566 1522
            713 1522
            ];
        advW = 853;
        
    case 'g'
        xy{1} = [
            1088 -143
            1014 -364
            938 -442
            789 -516
            566 -516
            418 -442
            435 -413
            574 -483
            781 -483
            918 -413
            986 -348
            1055 -139
            1055 177
            938 58
            789 -14
            566 -14
            416 58
            269 207
            195 428
            195 576
            269 797
            416 947
            566 1020
            789 1020
            938 947
            1055 828
            1055 1004
            1088 1004
            ];
        xy{2} = [
            1055 222
            1055 783
            918 918
            781 988
            574 988
            437 918
            297 781
            228 572
            228 433
            297 224
            437 86
            574 17
            781 17
            918 86
            ];
        advW = 1355;
        
    case 'h'
        xy{1} = [
            1088 0
            1055 0
            1055 715
            986 920
            852 988
            646 988
            508 918
            299 711
            299 0
            267 0
            267 1506
            299 1506
            299 756
            488 947
            637 1020
            861 1020
            1014 945
            1088 719
            ];
        advW = 1355;
        
    case 'i'
        xy{1} = [
            377 1434
            283 1340
            189 1434
            283 1528
            ];
        xy{2} = [
            299 0
            267 0
            267 1004
            299 1004
            ];
        xy{3} = [
            332 1434
            283 1483
            234 1434
            283 1385
            ];
        advW = 566;
        
    case 'j'
        xy{1} = [
            736 1434
            642 1340
            547 1434
            642 1528
            ];
        xy{2} = [
            658 -215
            584 -440
            431 -516
            287 -516
            287 -483
            422 -483
            555 -415
            625 -211
            625 1004
            658 1004
            ];
        xy{3} = [
            691 1434
            642 1483
            592 1434
            642 1385
            ];
        advW = 710;
        
    case 'k'
        xy{1} = [
            1084 11
            1059 -8
            570 549
            299 281
            299 0
            267 0
            267 1506
            299 1506
            299 326
            988 1016
            1012 992
            592 574
            ];
        advW = 1211;
        
    case 'l'
        xy{1} = [
            299 0
            267 0
            267 1506
            299 1506
            ];
        advW = 566;
        
    case 'm'
        xy{1} = [
            1876 0
            1844 0
            1844 715
            1774 920
            1641 988
            1434 988
            1297 918
            1088 711
            1088 0
            1055 0
            1055 715
            986 920
            852 988
            646 988
            508 918
            299 711
            299 0
            267 0
            267 1004
            299 1004
            299 756
            488 947
            637 1020
            861 1020
            1014 945
            1078 748
            1276 947
            1426 1020
            1649 1020
            1803 945
            1876 719
            ];
        advW = 2143;
        
    case 'n'
        xy{1} = [
            1088 0
            1055 0
            1055 715
            986 920
            852 988
            646 988
            508 918
            299 711
            299 0
            267 0
            267 1004
            299 1004
            299 756
            488 947
            637 1020
            861 1020
            1014 945
            1088 719
            ];
        advW = 1355;
        
    case 'o'
        xy{1} = [
            1160 428
            1086 207
            938 58
            789 -14
            566 -14
            416 58
            269 207
            195 428
            195 576
            269 797
            416 947
            566 1020
            789 1020
            938 947
            1086 797
            1160 576
            ];
        xy{2} = [
            1127 433
            1127 572
            1057 781
            918 918
            781 988
            574 988
            437 918
            297 781
            228 572
            228 433
            297 224
            437 86
            574 17
            781 17
            918 86
            1057 224
            ];
        advW = 1355;
        
    case 'p'
        xy{1} = [
            1160 428
            1086 207
            938 58
            789 -14
            566 -14
            416 58
            299 177
            299 -499
            267 -499
            267 1004
            299 1004
            299 828
            416 947
            566 1020
            789 1020
            938 947
            1086 797
            1160 576
            ];
        xy{2} = [
            1127 433
            1127 572
            1057 781
            918 918
            781 988
            574 988
            437 918
            299 783
            299 222
            437 86
            574 17
            781 17
            918 86
            1057 224
            ];
        advW = 1355;
        
    case 'q'
        xy{1} = [
            1088 -499
            1055 -499
            1055 177
            938 58
            789 -14
            566 -14
            416 58
            269 207
            195 428
            195 576
            269 797
            416 947
            566 1020
            789 1020
            938 947
            1055 828
            1055 1004
            1088 1004
            ];
        xy{2} = [
            1055 222
            1055 783
            918 918
            781 988
            574 988
            437 918
            297 781
            228 572
            228 433
            297 224
            437 86
            574 17
            781 17
            918 86
            ];
        advW = 1355;
        
    case 'r'
        xy{1} = [
            857 988
            646 988
            508 918
            369 781
            299 572
            299 0
            267 0
            267 1004
            299 1004
            299 674
            340 797
            488 947
            637 1020
            857 1020
            ];
        advW = 925;
        
    case 's'
        xy{1} = [
            1016 211
            941 58
            715 -14
            496 -14
            271 58
            197 207
            226 224
            295 86
            500 17
            711 17
            916 86
            984 220
            984 283
            916 418
            779 486
            420 557
            271 633
            193 789
            271 947
            496 1020
            715 1020
            941 947
            1014 797
            986 781
            916 918
            711 988
            500 988
            295 918
            230 789
            295 658
            433 590
            791 519
            941 443
            1016 291
            ];
        advW = 1211;
        
    case 't'
        xy{1} = [
            857 -14
            709 -14
            555 60
            482 285
            482 988
            283 988
            283 1020
            482 1020
            482 1506
            515 1506
            515 1020
            785 1020
            785 988
            515 988
            515 289
            584 84
            717 17
            857 17
            ];
        advW = 996;
        
    case 'u'
        xy{1} = [
            1088 0
            1055 0
            1055 248
            867 58
            717 -14
            494 -14
            340 60
            267 285
            267 1004
            299 1004
            299 289
            369 84
            502 17
            709 17
            846 86
            1055 293
            1055 1004
            1088 1004
            ];
        advW = 1355;
        
    case 'v'
        xy{1} = [
            1158 998
            731 0
            695 0
            269 998
            297 1010
            713 41
            1129 1010
            ];
        advW = 1140;
        
    case 'w'
        xy{1} = [
            1446 1000
            1160 0
            1126 0
            857 945
            587 0
            553 0
            267 1000
            299 1008
            570 60
            840 1004
            874 1004
            1143 60
            1414 1008
            ];
        advW = 1570;
        
    case 'x'
        xy{1} = [
            1084 11
            1059 -8
            678 476
            295 -8
            271 11
            656 502
            271 994
            295 1014
            676 529
            1059 1014
            1084 994
            699 502
            ];
        advW = 1211;
        
    case 'y'
        xy{1} = [
            1229 998
            799 -4
            584 -438
            504 -516
            283 -516
            283 -483
            492 -483
            555 -417
            766 0
            340 998
            369 1010
            785 41
            1201 1010
            ];
        advW = 1140;
        
    case 'z'
        xy{1} = [
            1033 1020
            244 17
            1000 17
            1000 -14
            179 -14
            967 988
            211 988
            211 1020
            ];
        advW = 1211;
        
    case ' '  % space
        xy{1} = [
            0 0
            ];
        advW = 1355;
        
    case '-'  % hypen
        xy{1} = [
            1553 629
            263 629
            263 662
            1553 662
            ];
        advW = 1856;
        
    case '!'
        xy{1} = [
            371 502
            338 502
            338 1506
            371 1506
            ];
        xy{2} = [
            449 72
            355 -20
            261 72
            355 166
            ];
        xy{3} = [
            404 72
            355 121
            306 72
            355 23
            ];
        advW = 925;
        
    case '#'
        xy{1} = [
            1215 701
            959 701
            859 303
            1143 303
            1143 271
            850 271
            658 -503
            625 -495
            818 271
            420 271
            228 -503
            195 -495
            388 271
            140 271
            140 303
            396 303
            496 701
            211 701
            211 734
            504 734
            697 1510
            730 1502
            537 734
            934 734
            1127 1510
            1160 1502
            967 734
            1215 734
            ];
        xy{2} = [
            926 701
            529 701
            429 303
            826 303
            ];
        advW = 1355;
        
    case '('
        xy{1} = [
            797 -487
            773 -512
            629 -366
            484 -149
            338 138
            267 500
            267 791
            338 1153
            484 1442
            629 1659
            773 1805
            797 1780
            654 1639
            512 1426
            371 1141
            299 787
            299 504
            371 150
            512 -133
            654 -346
            ];
        advW = 996;
        
    case ')'
        xy{1} = [
            730 500
            658 138
            512 -149
            367 -366
            224 -512
            199 -487
            342 -346
            484 -133
            625 150
            697 504
            697 787
            625 1141
            484 1426
            342 1639
            199 1780
            224 1805
            367 1659
            512 1442
            658 1153
            730 791
            ];
        advW = 996;
        
    case '*'
        xy{1} = [
            936 875
            920 846
            586 1047
            586 646
            553 646
            553 1047
            220 846
            203 875
            537 1076
            203 1276
            220 1305
            553 1104
            553 1506
            586 1506
            586 1104
            920 1305
            936 1276
            603 1076
            ];
        advW = 1140;
        
    case '+'
        xy{1} = [
            1573 629
            945 629
            945 0
            912 0
            912 629
            283 629
            283 662
            912 662
            912 1291
            945 1291
            945 662
            1573 662
            ];
        advW = 1856;
        
    case ','
        xy{1} = [
            443 -73
            369 -223
            295 -297
            271 -272
            340 -202
            410 -65
            410 33
            355 -20
            261 72
            355 166
            443 78
            ];
        xy{2} = [
            404 72
            355 121
            306 72
            355 23
            ];
        advW = 710;
        
    case '.'
        xy{1} = [
            449 72
            355 -20
            261 72
            355 166
            ];
        xy{2} = [
            404 72
            355 121
            306 72
            355 23
            ];
        advW = 710;
        
    case '/'
        xy{1} = [
            1444 1747
            154 -473
            125 -454
            1416 1766
            ];
        advW = 1570;
        
    case '\'
        xy{1} = [
            1444 -454
            1416 -473
            125 1747
            154 1766
            ];
        advW = 1570;
        
    case ':'
        xy{1} = [
            449 932
            355 838
            261 932
            355 1026
            ];
        xy{2} = [
            449 72
            355 -20
            261 72
            355 166
            ];
        xy{3} = [
            404 932
            355 981
            306 932
            355 883
            ];
        xy{4} = [
            404 72
            355 121
            306 72
            355 23
            ];
        advW = 1068;
        
    case ';'
        xy{1} = [
            449 932
            355 838
            261 932
            355 1026
            ];
        xy{2} = [
            443 -73
            369 -223
            295 -297
            271 -272
            340 -202
            410 -65
            410 33
            355 -20
            261 72
            355 166
            443 78
            ];
        xy{3} = [
            404 932
            355 981
            306 932
            355 883
            ];
        xy{4} = [
            404 72
            355 121
            306 72
            355 23
            ];
        advW = 996;
        
    case '<'
        xy{1} = [
            1295 15
            1278 -12
            107 646
            1278 1305
            1295 1276
            173 646
            ];
        advW = 1426;
        
    case '>'
        xy{1} = [
            1319 646
            148 -12
            132 15
            1254 646
            132 1276
            148 1305
            ];
        advW = 1426;
        
    case '='
        xy{1} = [
            1573 844
            283 844
            283 877
            1573 877
            ];
        xy{2} = [
            1573 414
            283 414
            283 447
            1573 447
            ];
        advW = 1856;
        
        
    case '?'
        xy{1} = [
            1088 1143
            1014 994
            938 918
            795 846
            658 711
            658 502
            625 502
            625 723
            775 875
            918 947
            986 1014
            1055 1151
            1055 1287
            988 1420
            783 1489
            574 1489
            437 1420
            369 1352
            299 1215
            299 1186
            355 1241
            449 1147
            355 1053
            267 1141
            267 1223
            340 1373
            416 1448
            566 1522
            787 1522
            1012 1448
            1088 1295
            ];
        xy{2} = [
            736 72
            642 -20
            547 72
            642 166
            ];
        xy{3} = [
            404 1147
            355 1196
            306 1147
            355 1098
            ];
        xy{4} = [
            691 72
            642 121
            592 72
            642 23
            ];
        advW = 1283;
        
    case '^'
        xy{1} = [
            1227 1303
            1203 1278
            713 1770
            224 1278
            199 1303
            713 1815
            ];
        advW = 1426;
        
    case '_'
        xy{1} = [
            1645 -157
            140 -157
            140 -125
            1645 -125
            ];
        advW = 1785;
        
    case '['
        xy{1} = [
            713 -516
            195 -516
            195 1809
            713 1809
            713 1776
            228 1776
            228 -483
            713 -483
            ];
        advW = 853;
        
    case ']'
        xy{1} = [
            658 -516
            140 -516
            140 -483
            625 -483
            625 1776
            140 1776
            140 1809
            658 1809
            ];
        advW = 853;
        
   
        
    otherwise
        error(['Glyph "',glyph,'" is not supported.'])
        
end


end



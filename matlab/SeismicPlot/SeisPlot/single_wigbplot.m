function single_wigbplot(data, i, t0, dt, x0, dx, num)
% 以变密度形式画地震记录子图
% 2023/9 中国地质大学（北京），地球物理与信息技术学院，五道口勘探员
% data：地震数据（矩阵，每一列代表一道地震记录）
% i：单道位置（指定要绘制的第几道地震记录）
% t0：记录起始时间，单位s（默认为0）
% dt：时间采样间隔，单位s（默认为0.002）
% dx：空间采样间隔（默认为1）
% x0：记录起始道位置（默认为1）
% num：振幅放大倍数（默认为1）

if nargin < 3
    t0 = 0; % 如果未提供t0参数，则默认记录起始时间为0s
end
if nargin < 4
    dt = 0.002; % 如果未提供dt参数，则默认时间采样间隔为0.002s
end
if nargin < 5
    x0 = 1; % 如果未提供x0参数，则默认记录起始道位置为1
end
if nargin < 6
    dx = 1; % 如果未提供dx参数，则默认空间采样间隔为1
end
if nargin < 7
    num = 1; % 如果未提供num参数，则默认振幅放大倍数为1
end

hold on; % 保持当前图形窗口，允许在同一图中叠加绘制

trace = data(:, i) * num; % 提取第i道地震记录，并乘以振幅放大倍数num
nt = length(trace); % 获取地震记录的时间采样点数
x = x0 + dx * (i - 1); % 计算当前道的x轴位置（空间位置）
t = t0 + (0:nt-1) * dt; % 生成时间轴，从t0开始，间隔为dt

plot(trace + x, t, 'r-', 'linewidth', 1.1); % 绘制地震记录曲线
% trace + x：将地震记录的振幅值偏移到x轴对应位置
% t：时间轴
% 'r-'：红色实线
% 'linewidth', 1.1：设置线宽为1.1